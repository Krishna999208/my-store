<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Tech Hub | Professional Store</title>
    <style>
        :root { --navy: #001f3f; --gold: #FFD700; --red: #ff4d4d; --green: #25D366; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #f4f7f6; }
        header { background: var(--navy); color: var(--gold); padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .container { max-width: 800px; margin: 20px auto; padding: 15px; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin-bottom: 20px; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; box-sizing: border-box; }
        .btn { background: var(--gold); color: var(--navy); border: none; padding: 15px; border-radius: 10px; cursor: pointer; font-weight: bold; width: 100%; font-size: 16px; transition: 0.3s; }
        .btn-wa { background: var(--green); color: white; margin-top: 10px; }
        .error-box { color: var(--red); font-weight: bold; display: none; margin-bottom: 10px; padding: 10px; border: 1px solid var(--red); border-radius: 8px; background: #fff5f5; }
        #checkout-view, #admin-view { display: none; }
        .order-card { border-left: 5px solid var(--gold); margin-bottom: 15px; padding: 15px; background: #fff; border-radius: 8px; }
    </style>
</head>
<body>

<header>
    <h1 style="margin:0; font-size: 20px;">SMART TECH HUB</h1>
    <div id="cart-count" style="font-weight:bold;">üõí Cart (0)</div>
</header>

<div class="container">
    <div id="shop-view">
        <div class="card">
            <h2 style="color:var(--navy);">New Arrival: Smart ITI Kit</h2>
            <p>Essential for Institute of Science and Education students.</p>
            <div style="font-size: 22px; font-weight: bold; color: var(--red); margin-bottom: 15px;">‚Çπ2,499</div>
            <button class="btn" onclick="addToCart('Smart ITI Kit', 2499)">üõí Add & Checkout</button>
        </div>
        <center><button onclick="openAdmin()" style="background:none; border:none; color:grey; cursor:pointer;">Admin Login</button></center>
    </div>

    <div id="checkout-view">
        <div class="card">
            <h2 style="color:var(--navy);">Delivery Details</h2>
            <div id="val-error" class="error-box"></div>
            
            <input type="text" id="cust-name" placeholder="Full Name (‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ)">
            <input type="number" id="cust-phone" placeholder="10 Digit Mobile Number">
            <textarea id="cust-address" rows="3" placeholder="Full Address (House No, Gali, Area, Purulia)"></textarea>
            
            <button class="btn btn-wa" onclick="placeOrder()">Place Order & WhatsApp ‚úÖ</button>
            <button onclick="location.reload()" style="background:none; border:none; margin-top:15px; width:100%; cursor:pointer; color:var(--navy);">‚Üê Cancel & Go Back</button>
        </div>
    </div>

    <div id="admin-view">
        <div class="card">
            <h2 style="color:var(--navy);">Live Orders Dashboard</h2>
            <div id="orders-list">Loading orders...</div>
            <button class="btn" style="background:#666; color:white; margin-top:20px;" onclick="location.reload()">Logout Admin</button>
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyC0fX9yqW...", // Your API Key
        projectId: "smart-tech-hub-477e2",
        appId: "1:999576773486:web:04deb401b9ffe8e1df2f1cc"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    let cart = [];
    const myWhatsApp = "918167746676";

    window.addToCart = (name) => {
        cart.push(name);
        document.getElementById('cart-count').innerText = `üõí Cart (${cart.length})`;
        document.getElementById('shop-view').style.display = 'none';
        document.getElementById('checkout-view').style.display = 'block';
    };

    window.placeOrder = async () => {
        const name = document.getElementById('cust-name').value.trim();
        const phone = document.getElementById('cust-phone').value.trim();
        const addr = document.getElementById('cust-address').value.trim();
        const errorBox = document.getElementById('val-error');

        // TOK-NA LOGIC (Validation)
        if(phone.length !== 10) {
            errorBox.innerText = "‚ùå ‡§ó‡§≤‡§§ ‡§®‡§Ç‡§¨‡§∞! ‡§ï‡•É‡§™‡§Ø‡§æ 10 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•á‡§Ç‡•§";
            errorBox.style.display = 'block';
            return;
        }
        if(addr.length < 20) {
            errorBox.innerText = "‚ùå ‡§è‡§°‡•ç‡§∞‡•á‡§∏ ‡§¨‡§π‡•Å‡§§ ‡§õ‡•ã‡§ü‡§æ ‡§π‡•à! ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§™‡§§‡§æ (Gali, Area) ‡§≤‡§ø‡§ñ‡•á‡§Ç‡•§";
            errorBox.style.display = 'block';
            return;
        }

        try {
            // Backup in Firebase
            await addDoc(collection(db, 'orders'), { name, phone, address: addr, items: cart.join(", "), time: new Date() });

            // Send to WhatsApp
            const msg = `üöÄ *NEW ORDER!*%0A*Name:* ${name}%0A*Phone:* ${phone}%0A*Address:* ${addr}%0A*Items:* ${cart.join(", ")}`;
            window.open(`https://wa.me/${myWhatsApp}?text=${msg}`, '_blank');
            
            alert("Order Saved! Shopkeeper ‡§ï‡•ã WhatsApp ‡§Æ‡•à‡§∏‡•á‡§ú ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§");
            location.reload();
        } catch (e) { alert("Error! Please try again."); }
    };

    window.openAdmin = () => {
        if(prompt("Admin Password:") === "1234") {
            document.getElementById('shop-view').style.display = 'none';
            document.getElementById('admin-view').style.display = 'block';
            loadOrders();
        }
    };

    async function loadOrders() {
        const q = query(collection(db, 'orders'), orderBy("time", "desc"));
        const snap = await getDocs(q);
        const list = document.getElementById('orders-list');
        list.innerHTML = '';
        snap.forEach(doc => {
            const d = doc.data();
            list.innerHTML += `
                <div class="order-card">
                    <b>Customer:</b> ${d.name}<br>
                    <b>Phone:</b> ${d.phone} <a href="tel:${d.phone}" style="color:blue; text-decoration:none;">[üìû Call Now]</a><br>
                    <b>Address:</b> ${d.address}<br>
                    <b>Items:</b> ${d.items}
                </div>`;
        });
    }
</script>
</body>
</html>
