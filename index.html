
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Smart Tech Hub | Professional Store</title>
    <!-- Modern Frameworks -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Urbanist', sans-serif; -webkit-tap-highlight-color: transparent; scroll-behavior: smooth; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .admin-dark { background-color: #0f172a; color: white; }
        .gold-btn { background: linear-gradient(135deg, #FFD700 0%, #ca8a04 100%); color: #001f3f; }
        @media print { .no-print { display: none !important; } .print-only { display: block !important; color: black; } .bill { border: 2px solid #000; padding: 25px; margin: 15px; } }
        .print-only { display: none; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-up { animation: slideUp 0.4s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 overflow-x-hidden">

    <!-- CUSTOMER VIEW (The Shop) -->
    <div id="customer-view" class="no-print min-h-screen">
        <header class="sticky top-0 z-50 glass px-6 py-4 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-2 cursor-pointer" id="logo-trigger">
                <div class="bg-[#0f172a] p-2 rounded-xl text-[#FFD700] shadow-md"><i class="fa-solid fa-envelope-circle-check text-xl"></i></div>
                <h1 class="text-2xl font-bold tracking-tighter text-[#0f172a]">SMART<span class="text-yellow-600">TECH</span></h1>
            </div>
            <div class="relative cursor-pointer bg-white p-3 rounded-full shadow-md border border-slate-100" onclick="openCart()">
                <i class="fa-solid fa-bag-shopping text-xl text-slate-700"></i>
                <span id="cart-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] rounded-full w-5 h-5 flex items-center justify-center border-2 border-white font-bold">0</span>
            </div>
        </header>

        <section class="px-6 py-12 text-center bg-white border-b border-slate-100">
            <span class="bg-blue-100 text-blue-700 px-4 py-1.5 rounded-full text-[10px] font-bold uppercase tracking-widest">Official Store â€¢ Purulia</span>
            <h2 class="text-4xl font-bold text-slate-900 mt-4 leading-tight">Professional Tech <br><span class="text-blue-600">At Your Doorstep.</span></h2>
            <p class="text-slate-500 mt-2 text-sm max-w-sm mx-auto">Select premium items and place orders via Email for maximum security.</p>
        </section>

        <main id="product-grid" class="px-6 py-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
            <!-- Products Loaded Here -->
            <p class="col-span-full text-center py-20 text-slate-400">Loading your store...</p>
        </main>
    </div>

    <!-- ORDER MODAL -->
    <div id="cart-modal" class="fixed inset-0 z-[100] hidden bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-0 sm:p-4 no-print">
        <div class="bg-white w-full max-w-md rounded-t-[2.5rem] sm:rounded-[2rem] p-8 shadow-2xl animate-up">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-slate-900">Confirm Order</h2>
                <button onclick="closeCart()" class="text-slate-400 bg-slate-100 p-2.5 rounded-full"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            <div id="error-box" class="hidden mb-6 p-4 bg-red-50 text-red-600 text-[10px] rounded-2xl border border-red-100 font-bold uppercase tracking-widest"></div>
            <div class="space-y-4">
                <div class="space-y-1">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-1">Full Name</label>
                    <input type="text" id="c-name" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter name">
                </div>
                <div class="space-y-1">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-1">Phone Number</label>
                    <input type="number" id="c-phone" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-2 focus:ring-blue-500" placeholder="10 Digit number">
                </div>
                <div class="space-y-1">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-1">Full Address</label>
                    <textarea id="c-addr" rows="3" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-2 focus:ring-blue-500" placeholder="Street, Area, Landmark, Purulia..."></textarea>
                </div>
                <button onclick="sendOrderEmail()" class="w-full bg-blue-600 text-white py-5 rounded-2xl font-bold text-lg shadow-xl flex items-center justify-center gap-3">Send via Gmail <i class="fa-solid fa-envelope text-2xl"></i></button>
            </div>
        </div>
    </div>

    <!-- ADMIN DASHBOARD -->
    <div id="admin-view" class="hidden min-h-screen admin-dark p-6 no-print">
        <div class="max-w-5xl mx-auto">
            <div class="flex justify-between items-center mb-8 border-b border-slate-800 pb-6">
                <div>
                    <h2 class="text-3xl font-bold text-yellow-500">Business Control</h2>
                    <p class="text-slate-500 text-[10px] uppercase font-bold tracking-widest">Digital Business Suite âœ…</p>
                </div>
                <button onclick="location.reload()" class="bg-red-500/20 text-red-400 px-6 py-2 rounded-xl font-bold">Log Out</button>
            </div>
            <div class="flex gap-10 mb-8 font-bold border-b border-slate-800 text-xs uppercase tracking-widest">
                <button onclick="tab('o')" id="tab-o" class="pb-4 text-yellow-500 border-b-2 border-yellow-500">All Orders</button>
                <button onclick="tab('s')" id="tab-s" class="pb-4 text-slate-500">Manage Products</button>
            </div>
            <div id="sec-o" class="space-y-6">
                <div id="admin-orders-list" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
            </div>
            <div id="sec-s" class="hidden">
                <div class="bg-white/5 p-8 rounded-3xl border border-white/10 mb-8">
                    <h4 class="text-xl font-bold text-yellow-500 mb-6">Add New Product</h4>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
                        <input type="text" id="p-name" class="bg-white/10 p-4 rounded-xl outline-none" placeholder="Product Title">
                        <input type="number" id="p-price" class="bg-white/10 p-4 rounded-xl outline-none" placeholder="Price (â‚¹)">
                        <input type="text" id="p-img" class="bg-white/10 p-4 rounded-xl outline-none" placeholder="Image Link (URL)">
                        <input type="text" id="p-desc" class="bg-white/10 p-4 rounded-xl outline-none" placeholder="Short Desc">
                        <button onclick="saveItemToCloud()" class="sm:col-span-2 gold-btn py-5 rounded-2xl font-bold text-lg">Save to Store âœ…</button>
                    </div>
                </div>
                <div id="admin-p-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
            </div>
        </div>
    </div>

    <!-- PRINT AREA -->
    <div id="print-view" class="print-only"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // FIREBASE CONFIG
        const firebaseConfig = { apiKey: "AIzaSyC0fX9yqW...", projectId: "smart-tech-hub-477e2", appId: "1:999576773486:web:04deb401b9ffe8e1df2f1cc" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appKey = "smart-tech-hub-pro-v4";
        const orderCol = collection(db, 'artifacts', appKey, 'public', 'data', 'orders');
        const productCol = collection(db, 'artifacts', appKey, 'public', 'data', 'products');

        let cart = [];
        let secretClicks = 0;
        const targetEmail = "ojhakrishna066@gmail.com"; 

        signInAnonymously(auth).then(() => { loadShop(); });

        // ADMIN ACCESS: 5 Clicks on Logo
        document.getElementById('logo-trigger').onclick = () => {
            secretClicks++;
            if(secretClicks === 5) {
                secretClicks = 0;
                if(prompt("Enter Admin Password:") === "9641882031") {
                    document.getElementById('customer-view').classList.add('hidden');
                    document.getElementById('admin-view').classList.remove('hidden');
                    loadAdminData();
                }
            }
            setTimeout(() => { secretClicks = 0; }, 3000);
        };

        window.loadShop = () => {
            onSnapshot(query(productCol, orderBy("time", "desc")), (snap) => {
                const grid = document.getElementById('product-grid'); grid.innerHTML = "";
                if(snap.empty) { grid.innerHTML = `<p class="col-span-full text-center py-20 text-slate-400">Store is empty. Add products from Admin.</p>`; }
                snap.forEach(dDoc => {
                    const p = dDoc.data();
                    grid.innerHTML += `<div class="bg-white p-6 rounded-[2.5rem] border border-slate-100 shadow-sm animate-up transition hover:shadow-lg"><div class="h-48 bg-slate-50 rounded-[2rem] mb-6 overflow-hidden flex items-center justify-center"><img src="${p.img}" class="object-cover w-full h-full" onerror="this.src='https://placehold.co/400x300?text=Premium+Tech'"></div><h3 class="text-xl font-bold px-2">${p.name}</h3><div class="flex justify-between items-center mt-8 px-2"><span class="text-2xl font-bold">â‚¹${p.price}</span><button onclick="addToCart('${p.name}', ${p.price})" class="bg-[#0f172a] text-[#FFD700] px-8 py-3.5 rounded-2xl font-bold">Buy</button></div></div>`;
                });
            });
        };

        window.addToCart = (n, p) => { cart.push({n, p}); document.getElementById('cart-badge').innerText = cart.length; openCart(); };
        window.openCart = () => { if(cart.length > 0) document.getElementById('cart-modal').classList.remove('hidden'); };
        window.closeCart = () => document.getElementById('cart-modal').classList.add('hidden');

        window.sendOrderEmail = async () => {
            const name = document.getElementById('c-name').value.trim();
            const phone = document.getElementById('c-phone').value.trim();
            const addr = document.getElementById('c-addr').value.trim();
            if(phone.length !== 10 || addr.length < 20) return alert("Please enter 10 digit number and full address!");
            
            const items = cart.map(i => i.n).join(", ");
            const total = cart.reduce((a, b) => a + b.p, 0);
            
            const mailBody = `Name: ${name}%0APhone: ${phone}%0AAddress: ${addr}%0AItems: ${items}%0ATotal: â‚¹${total}`;
            window.location.href = `mailto:${targetEmail}?subject=New Order - ${name}&body=${mailBody}`;

            await addDoc(orderCol, { name, phone, address: addr, items, total, status: 'Pending', time: new Date() });
            alert("Email Order Prepared! Please click SEND in your Gmail App. âœ…");
            location.reload();
        };

        window.tab = (t) => {
            document.getElementById('sec-o').classList.toggle('hidden', t !== 'o');
            document.getElementById('sec-s').classList.toggle('hidden', t !== 's');
            document.getElementById('tab-o').classList.toggle('text-yellow-500', t === 'o');
            document.getElementById('tab-o').classList.toggle('border-yellow-500', t === 'o');
            document.getElementById('tab-s').classList.toggle('text-yellow-500', t === 's');
            document.getElementById('tab-s').classList.toggle('border-yellow-500', t === 's');
        };

        window.saveItemToCloud = async () => {
            const name = document.getElementById('p-name').value;
            const price = parseFloat(document.getElementById('p-price').value);
            const img = document.getElementById('p-img').value || "https://placehold.co/400x300?text=Product";
            const desc = document.getElementById('p-desc').value;
            if(!name || isNaN(price)) return alert("Name and Price required!");
            await addDoc(productCol, { name, price, img, desc, time: new Date() });
            alert("Product Added to Store! âœ…");
            document.getElementById('p-name').value = ""; document.getElementById('p-price').value = "";
        };

        window.deleteItem = (id) => {
            if(confirm("Remove from store?")) deleteDoc(doc(db, 'artifacts', appKey, 'public', 'data', 'products', id));
        };

        window.confirmWhatsApp = (phone, name, id) => {
            // English Confirmation Message
            const msg = `Hello *${name}*,%0A%0AYour order at *Smart Tech Hub* has been confirmed! âœ…%0A%0AWe will deliver your items soon. Thank you for choosing us! ðŸ™`;
            window.open(`https://wa.me/91${phone}?text=${encodeURIComponent(msg)}`, '_blank');
            updateDoc(doc(db, 'artifacts', appKey, 'public', 'data', 'orders', id), { status: 'Confirmed' });
        };

        function loadAdminData() {
            onSnapshot(query(orderCol, orderBy("time", "desc")), (snap) => {
                const list = document.getElementById('admin-orders-list'); list.innerHTML = "";
                const print = document.getElementById('print-view'); print.innerHTML = "";
                snap.forEach(dDoc => {
                    const d = dDoc.data();
                    const isConfirmed = d.status === 'Confirmed';
                    list.innerHTML += `<div class="bg-white/5 p-6 rounded-[2.5rem] border border-white/10 animate-up"><div class="flex justify-between items-center mb-4"><h4 class="text-xl font-bold ${isConfirmed ? 'text-green-400' : 'text-yellow-500'}">${d.name}</h4><span class="text-[10px] text-slate-500 uppercase font-bold tracking-widest">${new Date(d.time.seconds*1000).toLocaleTimeString()}</span></div><p class="text-slate-300 text-sm mb-4"><i class="fa-solid fa-location-dot text-yellow-500"></i> ${d.address}</p><div class="flex flex-wrap gap-3"><a href="tel:${d.phone}" class="flex-1 min-w-[100px] bg-blue-500 text-white text-center py-3.5 rounded-2xl font-bold text-xs">Call</a><button onclick="confirmWhatsApp('${d.phone}', '${d.name}', '${dDoc.id}')" class="flex-1 min-w-[100px] bg-green-500 text-white py-3.5 rounded-2xl font-bold text-xs"><i class="fa-brands fa-whatsapp"></i> Confirm</button><button onclick="window.print()" class="flex-1 min-w-[100px] bg-white/10 py-3.5 rounded-2xl font-bold text-xs border border-white/10 text-white">Bill</button></div></div>`;
                    print.innerHTML += `<div class="bill"><center><h1>SMART TECH HUB</h1><p>Invoice Receipt</p></center><hr><p><b>Name:</b> ${d.name}</p><p><b>Phone:</b> ${d.phone}</p><p><b>Address:</b> ${d.address}</p><p><b>Items:</b> ${d.items}</p><p><b>Total:</b> â‚¹${d.total}</p></div>`;
                });
            });
            onSnapshot(query(productCol, orderBy("time", "desc")), (snap) => {
                const list = document.getElementById('admin-p-list'); list.innerHTML = "";
                snap.forEach(dDoc => {
                    const p = dDoc.data();
                    list.innerHTML += `<div class="bg-white/5 p-4 rounded-xl border border-white/10 flex justify-between text-white items-center"><span>${p.name}</span><button onclick="deleteItem('${dDoc.id}')" class="text-red-500 p-2"><i class="fa-solid fa-trash"></i></button></div>`;
                });
            });
        }
    </script>
</body>
</html>

